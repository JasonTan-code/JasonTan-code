<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Maximum likelihood estimation - Taotao Tan</title><meta name="Description" content="Taotao&#39;s Blog Posts"><meta property="og:title" content="Maximum likelihood estimation" />
<meta property="og:description" content="In this post, I will show you THE most important technique in inferential statistics: Maximum Likelihood Estimation (MLE).
 1. Some data to work with Before we get started, let&rsquo;s see what type of problem could be solved using MLE.
For example, I record the number of visitors of this website each hour from 8:00 am - 12:00 am (p.s. off course this is fake data, and I am probably too optimistic)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jasontan-code.github.io/posts/mle/" />
<meta property="og:image" content="https://jasontan-code.github.io/images/avatar.png"/>
<meta property="article:published_time" content="2021-11-22T15:18:26-06:00" />
<meta property="article:modified_time" content="2021-11-22T15:18:26-06:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://jasontan-code.github.io/images/avatar.png"/>

<meta name="twitter:title" content="Maximum likelihood estimation"/>
<meta name="twitter:description" content="In this post, I will show you THE most important technique in inferential statistics: Maximum Likelihood Estimation (MLE).
 1. Some data to work with Before we get started, let&rsquo;s see what type of problem could be solved using MLE.
For example, I record the number of visitors of this website each hour from 8:00 am - 12:00 am (p.s. off course this is fake data, and I am probably too optimistic)."/>
<meta name="application-name" content="Taotao&#39;s Blog Posts">
<meta name="apple-mobile-web-app-title" content="Taotao&#39;s Blog Posts"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://jasontan-code.github.io/posts/mle/" /><link rel="prev" href="https://jasontan-code.github.io/posts/calculate_pca/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Maximum likelihood estimation",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/jasontan-code.github.io\/posts\/mle\/"
        },"genre": "posts","keywords": "Statistics","wordcount":  856 ,
        "url": "https:\/\/jasontan-code.github.io\/posts\/mle\/","datePublished": "2021-11-22T15:18:26-06:00","dateModified": "2021-11-22T15:18:26-06:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Taotao"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Taotao Tan">Taotao Tan</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Taotao Tan">Taotao Tan</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Maximum likelihood estimation</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Taotao</a></span>&nbsp;<span class="post-category">included in <a href="/categories/statistics/"><i class="far fa-folder fa-fw"></i>Statistics</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-11-22">2021-11-22</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;856 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="true">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-some-data-to-work-with">1. Some data to work with</a></li>
    <li><a href="#2-lets-experiment-with-different-lambda">2. Let&rsquo;s experiment with different $\lambda$</a></li>
    <li><a href="#3-find-lambda_0">3. Find $\lambda_0$</a></li>
    <li><a href="#summary">Summary</a></li>
    <li><a href="#appendix">Appendix</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>In this post, I will show you <strong>THE</strong> most important technique in inferential statistics: Maximum Likelihood Estimation (MLE).</p>
<p> <br>
 </p>
<h2 id="1-some-data-to-work-with">1. Some data to work with</h2>
<p>Before we get started, let&rsquo;s see what type of problem could be solved using MLE.</p>
<p>For example, I record the number of visitors of this website each hour from 8:00 am - 12:00 am (<strong>p.s.</strong> off course this is fake data, and I am probably too optimistic). Here is my data:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Time</th>
<th style="text-align:right">Number of visitors</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">8:am - 9:am</td>
<td style="text-align:right">5</td>
</tr>
<tr>
<td style="text-align:left">9:am - 10:am</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:left">10:am - 11:am</td>
<td style="text-align:right">4</td>
</tr>
<tr>
<td style="text-align:left">11:am - 12:am</td>
<td style="text-align:right">6</td>
</tr>
</tbody>
</table>
<p>The first thing you need to do is to choose an appropriate probability distribution to describe your data. From your experience, you are happy with a poisson distribution, which has a probability mass function: $$f(x) = \frac{\lambda^x e^{- \lambda}}{x !}$$</p>
<p>where $x$ is our observed data and $\lambda$ the parameter we want to estimate.</p>
<p>(p.s. You can also use other distributions like negative binomial to model count data.)</p>
<p> <br>
 
 <br>
 </p>
<h2 id="2-lets-experiment-with-different-lambda">2. Let&rsquo;s experiment with different $\lambda$</h2>
<blockquote>
<p>Try $\lambda = 2$.</p>
<p>The core question here is:<br>
<strong>Assume $\lambda = 2$, then what is the probability of observing our data?</strong></p>
<p>That shouldn&rsquo;t be difficult to answer. We first plug $\lambda = 2$ into the probability mass function, and get: $$f(x) = \frac{2^x e^{- 2}}{x !}$$</p>
<p>Now we can calculate the probability of have exact 5 visitors in 1-hour duration.  $f(x = 5) = \frac{2^5 e^{- 2}}{5 !} = 0.036$</p>
<p>Similarly, we have:<br>
$f(x = 3) = \frac{2^3 e^{- 2}}{3 !} = 0.18$<br>
$f(x = 4) = \frac{2^4 e^{- 2}}{4 !} = 0.09$<br>
$f(x = 6) = \frac{2^6 e^{- 2}}{6 !} = 0.012$</p>
<p>Since our sample is independent and identically distributed (a.k.a.  i.i.d), <strong>the probability of observing our data ($[5,3,4,6]$) given $\lambda = 2$, is simply the product of the probabilities we have calculated</strong>:</p>
<p>$$P(data | \lambda = 2) = 0.036 \times 0.18 \times 0.09 \times 0.012 = 7 \times 10^{-6}$$</p>
</blockquote>
<blockquote>
<p>Try $\lambda = 4$</p>
<p>The calculation is exactly the same, and I am not going to repeat this. But here is the result:<br>
$f(x = 5) = 0.156$ <br>
$f(x = 3) = 0.195$<br>
$f(x = 4) = 0.195$<br>
$f(x = 6) = 0.104$<br>
Again, we want to calculate the probability of observing those data, given $\lambda = 4$:
$$P(data | \lambda = 4) = 0.156 \times 0.195 \times 0.195 \times 0.104 = 6.2 \times 10^{-4}$$</p>
</blockquote>
<p>Notice the conditional probability in our example $P(data | \lambda = \lambda_0)$, is also called <strong>likelihood function:</strong> $L(\lambda = \lambda_0 | data)$</p>
<p>Also notice that when we change $\lambda$, the result of $\prod_ip(x_i | \lambda) $ (a.k.a. likelihood function) also change. In our example, when $\lambda$ change from 2  to 4, our likelihood function increased.</p>
<p><strong>The Goal of MLE is to find $\lambda_0$, so that the likelihood function reach its largest value</strong></p>
<p> <br>
 
 <br>
 </p>
<h2 id="3-find-lambda_0">3. Find $\lambda_0$</h2>
<p>Now the question become clear, we have:<br>
$$
L( \lambda| data) = P(data| \lambda) = f_{\lambda}(5) \times  f_{\lambda}(3) \times  f_{\lambda}(4) \times  f_{\lambda}(6)  \\
= \frac{\lambda^5 e^{- \lambda}}{5 !} \times \frac{\lambda^3 e^{- \lambda}}{3 !} \times \frac{\lambda^4 e^{- \lambda}}{4 !} \times \frac{\lambda^6 e^{- \lambda}}{6 !}
$$</p>
<p>And we are trying to find the $\lambda_0$ to make sure the $L( \lambda_0 | data)$ is the greatest. In mathematical notation:</p>
<p>$$
\underset{\lambda}{\mathrm{argmax}} (L( \lambda | data))
$$</p>
<p>Obviously, you can take the derivative of the likelihood function to find the maximum value, but this is beyond the scope of this blog. However, if you are interested, please check the appendix. I drew a graph to show you the relationship between $\lambda$ and $L( \lambda | data)$</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/MLE/MLE.png"
        data-srcset="/images/MLE/MLE.png, /images/MLE/MLE.png 1.5x, /images/MLE/MLE.png 2x"
        data-sizes="auto"
        alt="/images/MLE/MLE.png"
        title="/images/MLE/MLE.png" /></p>
<p>You can visually tell, when $\lambda = 4.5$, our likelihood function reaches its maximum.</p>
<p>In fact, $\lambda = 4.5$ is the average number of our data, and this is not a coincidence~</p>
<p> <br>
 <br>
 </p>
<h2 id="summary">Summary</h2>
<p>In summary, when we observed a set of data $[5,3,4,6]$ and we believed our data is from a poisson distribution, the &ldquo;best guess&rdquo; (under frequentist&rsquo;s framework) of that poisson distribution is that it has $\hat \lambda = 4.5$</p>
<p> <br>
 </p>
<p>That&rsquo;s the end of this blog. Thanks for reading.</p>
<p> <br>
 
 <br>
 </p>
<hr>
<h2 id="appendix">Appendix</h2>
<p>We have the likelihood function:</p>
<p>$$
L(\lambda | data) = \frac{\lambda^5 e^{- \lambda}}{5 !} \times \frac{\lambda^3 e^{- \lambda}}{3 !} \times \frac{\lambda^4 e^{- \lambda}}{4 !} \times \frac{\lambda^6 e^{- \lambda}}{6 !}
$$</p>
<p>Let $$g(\lambda) = log(L(\lambda | data))$$</p>
<p>Adding $log$ wouldn&rsquo;t change the place where the function reach its peak. Therefore, we can just find the $\lambda$ that maximizes $g(\lambda)$.</p>
<p>After applying logarithm, we have
$$
g(\lambda) = log(\frac{\lambda^5 e^{- \lambda}}{5 !} \times \frac{\lambda^3 e^{- \lambda}}{3 !} \times \frac{\lambda^4 e^{- \lambda}}{4 !} \times \frac{\lambda^6 e^{- \lambda}}{6 !})
$$</p>
<p>Since logarithm covert product to summation, we have:</p>
<p>$$
g(\lambda) = [log(\lambda ^5) - \lambda - log(5!) ]+ [log(\lambda ^3) - \lambda - log(3!)] \\\ + [log(\lambda ^4) - \lambda - log(4!)]+[log(\lambda ^6) - \lambda - log(6!)]
$$</p>
<p>We then take the derivative of $g(\lambda)$:</p>
<p>$$
g(\lambda)' = \frac{5}{\lambda} - 1 + \frac{3}{\lambda} - 1  + \frac{4}{\lambda} - 1  +\frac{6}{\lambda} - 1
$$</p>
<p>Let $g(\lambda)' = 0$, we have:</p>
<p>$$
\frac{5}{\lambda} - 1 + \frac{3}{\lambda} - 1  + \frac{4}{\lambda} - 1  +\frac{6}{\lambda} - 1  = 0
$$</p>
<p>Solve $\lambda$, we have:</p>
<p>$$
\lambda = 4.5
$$</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2021-11-22</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://jasontan-code.github.io/posts/mle/" data-title="Maximum likelihood estimation" data-via="doubleTaoTan" data-hashtags="Statistics"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://jasontan-code.github.io/posts/mle/" data-hashtag="Statistics"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://jasontan-code.github.io/posts/mle/" data-title="Maximum likelihood estimation" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://jasontan-code.github.io/posts/mle/" data-title="Maximum likelihood estimation"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://jasontan-code.github.io/posts/mle/" data-title="Maximum likelihood estimation"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="Share on Myspace" data-sharer="myspace" data-url="https://jasontan-code.github.io/posts/mle/" data-title="Maximum likelihood estimation" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="Share on Blogger" data-sharer="blogger" data-url="https://jasontan-code.github.io/posts/mle/" data-title="Maximum likelihood estimation" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="Share on Evernote" data-sharer="evernote" data-url="https://jasontan-code.github.io/posts/mle/" data-title="Maximum likelihood estimation"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/statistics/">Statistics</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/calculate_pca/" class="prev" rel="prev" title="Calculate PCA by hand"><i class="fas fa-angle-left fa-fw"></i>Calculate PCA by hand</a></div>
</div>
<div id="comments"><div id="fb-root" class="comment"></div>
            <div
                class="fb-comments"
                data-href="https://jasontan-code.github.io/posts/mle/"
                data-width="100%"
                data-numposts="10"
            ></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://developers.facebook.com/docs/plugins/comments/"></a>Facebook</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.80.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v5.0&amp;appId=2162149760591137&amp;autoLogAppEvents=1" defer></script><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-C4MZRQHWVE', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-C4MZRQHWVE" async></script></body>
</html>
